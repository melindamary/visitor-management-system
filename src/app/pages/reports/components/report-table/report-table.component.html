
  <button class="export-button" 
    (click)="exportSelectedToExcel()"
  ><i class="pi pi-file-excel excel-icon"></i></button>


<p-table
  styleClass="p-datatable-striped " 
  [columns]="cols"
  [value]="reports"
  [tableStyle]="{ 'min-width': '50rem', 'width':'110rem' }"
  [paginator]="true"
  [rows]="10"
  [scrollable]="true" 
  scrollHeight="61vh" 
  [rowsPerPageOptions]="[5, 10, 20]"
  sortMode="multiple"
  selectionMode="multiple"
  [(selection)]="selectedReports"

>
  <ng-template pTemplate="header" let-columns>
    <tr>
      <th><p-tableHeaderCheckbox /></th>
        <th *ngFor="let col of columns" [pSortableColumn]="isSortable(col.field)? col.field : null">
        <div class="flex align-items-center">
            {{ col.header }} 
            <p-sortIcon *ngIf="isSortable(col.field)" [field]="col.field" />
            
        </div>
      </th>
      <th>Actions</th>
    </tr>
    <tr>
      <th class="search-header"></th>
      <th class="search-header" *ngFor="let col of columns">
          <p-columnFilter
              *ngIf="col.field !== 'slNo'"
              type="text" [field]="col.field" [matchMode]="'contains'"
              [placeholder]="'Search...'"
          ></p-columnFilter>
      </th>
      <th class="search-header"></th>
  </tr>
  </ng-template>
  <ng-template pTemplate="body" let-rowData let-columns="columns">
    <tr [pSelectableRow]="rowData" [pSelectableRowIndex]="columns">
      <td><p-tableCheckbox [value]="rowData" /></td>
      <td *ngFor="let col of columns"  [style.width]="col.width || 'auto'">
        {{ rowData[col.field] }}
      </td>
      <td>
        <p-button 
            class="view-btn"
            pRipple
            pRipple 
            icon="pi pi-eye" 
            [outlined]="true" 
            (onClick)="viewDetails(rowData)" 
          />
        </td>
    </tr>
  </ng-template>
</p-table>
